---
image: Visual Studio 2017

version: "{build}"

install:
  # Binary taken from http://w858rkbfg.homepage.t-online.de/index.php/software/ragel-windows/,
  # rehosted on AWS so it doesn't randomly vanish.
  - vcpkg install ragel
  - SET PATH=C:\Ruby%ruby_version%\bin;%PATH%
  - bundle install --retry 3

cache: C:\tools\vcpkg\installed\

build: off

before_test:
  - ruby --version
  - gem --version
  - bundle --version

test_script:
  - rake

environment:
  matrix:
    - ruby_version: "22"
    - ruby_version: "22-x64"
    - ruby_version: "23"
    - ruby_version: "23-x64"
    - ruby_version: "24"
    - ruby_version: "24-x64"

skip_tags: true

notifications:
  -
    provider: Email
    on_build_success: false
    on_build_failure: false
    on_build_status_changed: true
