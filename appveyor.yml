---
image: Visual Studio 2017

version: "{build}"

install:
  - if "%platform%"=="Win32" set VCPKG_ARCH=x86-windows
  - if "%platform%"=="x64"   set VCPKG_ARCH=x64-windows
  - vcpkg install ragel:%VCPKG_ARCH%
  - SET PATH=C:\tools\vcpkg\installed\%VCPKG_ARCH%\bin;%PATH%
  - SET PATH=C:\Ruby%ruby_version%\bin;%PATH%
  - bundle install --retry 3

cache: C:\tools\vcpkg\installed

build: off

before_test:
  - ragel --version
  - ruby --version
  - gem --version
  - bundle --version

test_script:
  - rake

environment:
  matrix:
    - ruby_version: "22"
    - ruby_version: "22-x64"
    - ruby_version: "23"
    - ruby_version: "23-x64"
    - ruby_version: "24"
    - ruby_version: "24-x64"

skip_tags: true

notifications:
  -
    provider: Email
    on_build_success: false
    on_build_failure: false
    on_build_status_changed: true
